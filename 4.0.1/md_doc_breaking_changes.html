<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EleFits: Breaking changes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="elefits_notext.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EleFits
   &#160;<span id="projectnumber">4.0.1</span>
   </div>
   <div id="projectbrief">A modern C++ API on top of CFitsIO</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Breaking changes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md9">Breaking changes in 4.0</a><ul><li class="level2"><a href="#autotoc_md10">Introduction</a></li>
<li class="level2"><a href="#autotoc_md11">EL_FitsIO becomes EleFits and associated changes</a></li>
<li class="level2"><a href="#autotoc_md12">3rd handler level</a></li>
<li class="level2"><a href="#autotoc_md13">RecordHdu becomes Hdu</a></li>
<li class="level2"><a href="#autotoc_md14">FitsFile::Permission becomes FileMode</a></li>
<li class="level2"><a href="#autotoc_md15">HduType becomes HduCategory</a></li>
<li class="level2"><a href="#autotoc_md16">MefFile::accessPrimary() becomes MefFile::primary() and is not a template anymore</a></li>
<li class="level2"><a href="#autotoc_md17">Raster::shape and Column::info become methods</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md18">Breaking changes in 3.0</a><ul><li class="level2"><a href="#autotoc_md19">All indices are 0-based</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md20">Breaking changes in 2.0</a><ul><li class="level2"><a href="#autotoc_md21">Method name change</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md9"></a>
Breaking changes in 4.0</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
Introduction</h2>
<p>Version 4.0 introduces many changes to the API. Most of them are already in place in version 3.2, but with backward compatibility ensured by aliases. This is done to make transition smoother on client code side. Therefore, in 3.2, the user can use both 3.x and 4.x versions of the API. Items removed from the API in 4.0 are marked deprecated in 3.2.</p>
<p>For each breaking change, this page details the underlying reasons, the status in version 3.2, and how to adapt the client code.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
EL_FitsIO becomes EleFits and associated changes</h2>
<p>Namespace <code>FitsIO</code> becomes <code>Fits</code>. Prefix <code>EL_Fits</code> (resp. <code>EL_FITSIO</code>) becomes <code>EleFits</code> (resp. <code>ELEFITS</code>). <code>EL_FitsFile</code> becomes <code>EleFits</code>. Underscores in program names are removed.</p>
<p><b>Rationale</b></p>
<ul>
<li>Underscores are forbidden by some package managers;</li>
<li>Easier to say, read and write;</li>
<li>"EL" stands for <a class="el" href="namespaceEuclid.html" title="Euclid SGS namespace.">Euclid</a> library, while the project is instead a package with libraries and executables; "Ele" stands for <a class="el" href="namespaceEuclid.html" title="Euclid SGS namespace.">Euclid</a> libraries and executables.</li>
</ul>
<p><b>Status in version 3.2</b></p>
<p>Change not applied: compatibility with 4.0 cannot be anticipated in code which depends on 3.2.</p>
<p><b>Impact on client code</b></p>
<ul>
<li>Find and replace word <code>EL_FitsIO</code> with <code>EleFits</code> in CMakeLists';</li>
<li>Find and replace prefix <code>EL_Fits</code> with <code>EleFits</code> in CMakeLists' and in includes;</li>
<li>Find and replace prefix <code>EL_FITSIO</code> with <code>ELEFITS</code> in macros;</li>
<li>Find and replace <code>FitsIO</code> (e.g. namespace <code>FitsIO</code> or class <code>FitsIOError</code>) with <code>Fits</code> in sources;</li>
<li>Remove underscores from program names in command lines.</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
3rd handler level</h2>
<p>In addition to file- and HDU-level handlers, additional classes are defined at header or data level. For example, records are accessed through <code>MefFile</code>/<code>RecordHdu</code>/<code>Header</code> instead of <code>MefFile</code>/<code>RecordHdu</code>:</p>
<div class="fragment"><div class="line"><span class="comment">// Until 4.0</span></div>
<div class="line">f.access&lt;&gt;(3).<a class="code" href="namespaceEuclid_1_1Cfitsio_1_1HeaderIo.html#abef88f5a9c00e95d60fe1e8fc63134cb">writeRecord</a>(<span class="stringliteral">&quot;KEY&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Since 4.0</span></div>
<div class="line">f.access&lt;&gt;(3).header().write(<span class="stringliteral">&quot;KEY&quot;</span>, 1);</div>
</div><!-- fragment --><p><b>Rationale</b></p>
<ul>
<li>Better mapping to Fits structure (separate header unit and data unit);</li>
<li>Cleaner <code>SifFile</code> (e.g. no more useless <code>index()</code> method);</li>
<li>Better application of the Single Responsibility Principle (e.g. <code>BintableHdu</code> goes from 57 methods to 15 in <code>BintableColumns</code>);</li>
<li>Better structured documentation, while many more services are provided;</li>
<li>Enable row-wise binary table I/Os.</li>
</ul>
<p><b>Status in version 3.2</b></p>
<p>Header- and data-level handlers are implemented. Methods in HDU-level handlers still exist for backward compatibility, although they are marked deprecated.</p>
<p><b>Impact on client code</b></p>
<ul>
<li>Manual fix: 1 to 2 more calls in user code for each HDU;</li>
<li>Negligible impact on runtime.</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
RecordHdu becomes Hdu</h2>
<p><b>Rationale</b></p>
<ul>
<li>Given the new handler level, <code>(Record)Hdu</code> is not responsible anymore for record I/Os;</li>
<li>Inheritance is more explicit: <code>ImageHdu</code> and <code>BintableHdu</code> both extend <code>Hdu</code>.</li>
</ul>
<p><b>Status in version 3.2</b></p>
<p>Name has changed. Deprecated alias <code>RecordHdu</code> is provided for backward-compatibility.</p>
<p><b>Impact on client code</b></p>
<ul>
<li>Find and replace word <code>RecordHdu</code> with <code>Hdu</code>, including in include directives.</li>
</ul>
<h2><a class="anchor" id="autotoc_md14"></a>
FitsFile::Permission becomes FileMode</h2>
<p><b>Rationale</b></p>
<ul>
<li>More classical;</li>
<li>Analogous to <code>RecordMode</code>;</li>
<li>Remove useless scoping, shorten usage.</li>
</ul>
<p><b>Status in version 3.2</b></p>
<p>Name and scope have changed. A deprecated alias <code>FitsFile::Permission</code> is provided for backward compatibility.</p>
<p><b>Impact on client code</b></p>
<ul>
<li>Find and replace occurrences of <code>FitsFile::Permission</code>, <code>SifFile::Permission</code> and <code>MefFile::Permission</code> with <code>FileMode</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md15"></a>
HduType becomes HduCategory</h2>
<p>And it is now a proper class instead of an enum.</p>
<p><b>Rationale</b></p>
<ul>
<li>Much richer concept now, e.g. with support for HDU state filtering;</li>
<li>Enable implementation of HDU selectors, along with iterators;</li>
<li>Analogous usage to <code>KeywordCategory</code>.</li>
</ul>
<p><b>Status in version 3.2</b></p>
<p>Name has changed. A deprecated alias <code>HduType</code> is provided for backward compatibility.</p>
<p><b>Impact on client code</b></p>
<ul>
<li>Find and replace occurrences of word <code>HduType</code> with <code>HduCategory</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md16"></a>
MefFile::accessPrimary() becomes MefFile::primary() and is not a template anymore</h2>
<p>An <code>ImageHdu</code> is always returned by <code>MefFile::primary()</code>.</p>
<p><b>Rationale</b></p>
<ul>
<li>The Primary is always an image;</li>
<li>With the 3rd handler layer, there is no more reason to return a <code>RecordHdu</code> (see impact below).</li>
</ul>
<p><b>Status is version 3.2</b></p>
<p>Both <code>MefFile::accessPrimary&lt;T&gt;()</code> and <code>MefFile::primary()</code> are implemented.</p>
<p><b>Impact on client code</b></p>
<ul>
<li>Replace <code>MefFile::accessPrimary&lt;Hdu&gt;()</code> and <code>MefFile::accessPrimary&lt;ImageHdu&gt;()</code> with <code>MefFile::access()</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md17"></a>
Raster::shape and Column::info become methods</h2>
<p><b>Rationale</b></p>
<p>Data classes should ensure data integrity as much as possible. This is not possible with member variables.</p>
<p><b>Status in version 3.2</b></p>
<p>Not implemented.</p>
<p><b>Impact on client code</b></p>
<ul>
<li>For reading, replace <code>raster.shape</code> and <code>column.info</code> with <code>raster.shape()</code> and <code>column.info()</code>.</li>
<li>The values cannot be changed after construction (at least for now).</li>
</ul>
<h1><a class="anchor" id="autotoc_md18"></a>
Breaking changes in 3.0</h1>
<h2><a class="anchor" id="autotoc_md19"></a>
All indices are 0-based</h2>
<p>Most indices in 2.0 were 0-based (e.g. in <code>Raster</code> and <code>Column</code>). A notable exception was the HDU index, which used to follow the CFitsIO convention. Yet, the Fits standard doesn't set any convention for HDU indices (well, HDU indices are not even mentioned in the standard). Therefore, it was decided to homogeneize indexing, and follow the C++ convention instead.</p>
<p>For more details, see <a class="el" href="group__types.html">On types</a>.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
Breaking changes in 2.0</h1>
<h2><a class="anchor" id="autotoc_md21"></a>
Method name change</h2>
<ul>
<li>Method name case is now pascalCase, according to <a class="el" href="namespaceEuclid.html" title="Euclid SGS namespace.">Euclid</a> quality rules;</li>
<li>Method names are homogeneized. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="anamespaceEuclid_1_1Cfitsio_1_1HeaderIo_html_abef88f5a9c00e95d60fe1e8fc63134cb"><div class="ttname"><a href="namespaceEuclid_1_1Cfitsio_1_1HeaderIo.html#abef88f5a9c00e95d60fe1e8fc63134cb">Euclid::Cfitsio::HeaderIo::writeRecord</a></div><div class="ttdeci">void writeRecord(fitsfile *fptr, const Fits::Record&lt; T &gt; &amp;record)</div><div class="ttdoc">Write a new record.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.19
</small></address>
</body>
</html>
