<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EleFits: On types</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="elefits_notext.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EleFits
   &#160;<span id="projectnumber">4.0.0</span>
   </div>
   <div id="projectbrief">A modern C++ API on top of CFitsIO</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">On types<div class="ingroups"><a class="el" href="group__guidelines.html">Development guidelines</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>Which types to use? </p>
<h1><a class="anchor" id="types-indices"></a>
Indices</h1>
<p>Indices in the <a class="el" href="namespaceEuclid_1_1Fits.html" title="Wrapper classes to read and write Fits file contents.">Fits</a> namespace are 0-based <code>long</code>s. Here is why.</p>
<p>There is no way to make everybody happy:</p>
<ul>
<li><a class="el" href="namespaceEuclid_1_1Fits.html" title="Wrapper classes to read and write Fits file contents.">Fits</a> generally relies on 1-based integers, sign-ness of which is undefined;</li>
<li>HDUs have no index in the <a class="el" href="namespaceEuclid_1_1Fits.html" title="Wrapper classes to read and write Fits file contents.">Fits</a> definition: they are just contiguous in the file;</li>
<li>C uses 0-based signed integers;</li>
<li>The C++ standard library uses 0-based unsigned integers;</li>
<li>CFitsIO uses 1-based signed integers with varying type (e.g. <code>int</code> for column count and <code>long</code> or <code>LONGLONG</code> for row count).</li>
</ul>
<p>Following the <a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-subscripts">C++ Core Guidelines</a>, we've opted for signed integers, and precisely for <code>long</code>'s. To reduce the noise, we did not create a custom type like "index", "length" or "size". We do not rely on <code>ptrdiff_t</code> as suggested in the Guidelines, because it would create issues when interfacing internally with CFitsIO. Using <code>long</code>s conveys the following message: trying to use something larger than the max of <code>long</code> won't work.</p>
<p>Having signed indices also enables backard indexing, where -1 means the last index. This is supported, for example, by the <code><a class="el" href="classEuclid_1_1Fits_1_1Raster_a01218345562cd9505b286af1d221d37d.html#a01218345562cd9505b286af1d221d37d" title="Access the value at given position.">Raster::at()</a></code> and <code><a class="el" href="classEuclid_1_1Fits_1_1Column_a607c5673b21c2c648ce16f0d6ada2b8a.html#a607c5673b21c2c648ce16f0d6ada2b8a" title="Access the value at given row and repeat indices.">Column::at()</a></code> methods.</p>
<p>Since indices in <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html" title="STL class.">std::vector</a></code>s are 0-based, and we use a lot of <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html" title="STL class.">std::vector</a></code>s, we follow the same convention to provide a fully consistent API. This way, the user code only copes with 0-based indices.</p>
<h1><a class="anchor" id="types-data"></a>
Data types</h1>
<p>As shown in the <a class="el" href="type_map.html">CFitsIO type mapping table</a>, handling data types right with CFitsIO can be very cumbersome. EleFits aims at carrying the boilerplate internally, so that the user doesn't need to know the underlying architecture or CFitsIO implementation. Template functions and methods are provided to simply let the user set the desired type, e.g.:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> raster = ext.readRaster&lt;<span class="keywordtype">float</span>&gt;();</div>
</div><!-- fragment --><p>When possible, conversions are performed internally when the template type does not correspond to the file type.</p>
<h2><a class="anchor" id="types-data-int"></a>
Integers</h2>
<p>Integer types are numerous. There are two main categories: fixed-size integers (e.g. <code><a class="elRef" href="http://en.cppreference.com/w/cpp/types/integer.html">std::int32_t</a></code>) and C integers (e.g. <code>int</code>). It is strongly recommended to use fixed-size integers to avoid bad surprises when changing the system. Indeed, if an image of pixel type <code>int</code> is written on a system where it is encoded as a 64-bit integers, and read on a system where it is encoded as a 32-bit integer, values will be corrupted. This is avoided by using <code><a class="elRef" href="http://en.cppreference.com/w/cpp/types/integer.html">std::int32_t</a></code> instead.</p>
<p>The <a class="el" href="namespaceEuclid_1_1Fits.html" title="Wrapper classes to read and write Fits file contents.">Fits</a> format doesn't natively support unsigned integers or signed bytes. Yet, CFitsIO and EleFits rely on the scaling mechanism to support them: an unsigned integer value will be internally offset to get a signed integer in the file. The offset is written in the file as a <code>BZERO</code> (image HDU) or <code>TZERO</code> (binary table HDU) keyword record, used to correctly recover the value at reading.</p>
<h2><a class="anchor" id="types-data-string"></a>
String</h2>
<p>Strings are represented as <code><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html" title="STL class.">std::string</a></code> and not <code>const char*</code> in general. Yet, a few sevices are overloaded with <code>const char*</code> for convenience.</p>
<h2><a class="anchor" id="types-data-variant"></a>
VariantValue</h2>
<p>In addition to CFitsIO data types, EleFits provides some of the services for <code>VariantValue</code> (e.g., to read records). In this case, the underlying type is wrapped in a <code>VariantValue</code> object, which can be cast later.</p>
<p>Development efforts have been put to allow the user to get whatever compatible type from the <code>VariantValue</code> object. For example, assume some <code>unsigned long</code> record value is read as a <code>VariantValue</code>. The library will allow the user casting to <code>long long</code> because this is a mathematically valid conversion, where <code>std::any_cast&lt;long long&gt;()</code> and the likes would throw an exception. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.19
</small></address>
</body>
</html>
